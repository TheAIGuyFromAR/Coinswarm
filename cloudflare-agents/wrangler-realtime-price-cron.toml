# Wrangler configuration for Real-Time Price Collection Cron Worker

name = "coinswarm-realtime-price-cron"
main = "realtime-price-collection-cron.ts"
compatibility_date = "2024-01-01"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "coinswarm-evolution"
database_id = "ac4629b2-8240-4378-b3e3-e5262cd9b285"

# Cron trigger - runs every minute
[triggers]
crons = ["* * * * *"]  # Every minute

# API Keys (Secrets - set via GitHub Secrets or `wrangler secret put`)
# DO NOT commit actual API keys to this file!
#
# To set secrets locally:
#   wrangler secret put COINGECKO --config wrangler-realtime-price-cron.toml
#   wrangler secret put CRYPTOCOMPARE_API_KEY --config wrangler-realtime-price-cron.toml
#
# To set via GitHub Actions, add to repository secrets:
#   COINGECKO - CoinGecko Demo/Pro API key
#   CRYPTOCOMPARE_API_KEY - CryptoCompare API key
#
# Intelligent round-robin with leaky bucket algorithm:
#   - CoinGecko: 7.5 calls/min (25% of 30)
#   - CryptoCompare: 7.5 calls/min (25% of 30)
#   - Binance.US: 300 weight/min (25% of 1200)
#   - DexScreener: 75 calls/min (25% of 300)
#
# Chooses source with highest available capacity percentage each minute
