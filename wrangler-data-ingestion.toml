# Cloudflare Workers Configuration - Data Backfill Worker
# Aggressive backfilling of historical data until sources exhausted

name = "coinswarm-data-backfill"
main = "cloudflare-workers/data-backfill-worker.js"
compatibility_date = "2024-01-01"

# Account ID - Set via environment variable CLOUDFLARE_ACCOUNT_ID or GitHub Secrets
# account_id = "YOUR_ACCOUNT_ID_HERE"

# Cron trigger: Run every minute for aggressive backfilling
# Disable this once backfill is complete to save resources
[triggers]
crons = ["* * * * *"]

# D1 Database binding
[[d1_databases]]
binding = "DB"  # Available in worker as env.DB
database_name = "coinswarm-historical-data"
database_id = "ac4629b2-8240-4378-b3e3-e5262cd9b285"

# Environment variables
# API keys should be added as secrets, not environment variables
# Use: wrangler secret put CRYPTOCOMPARE_API_KEY --name coinswarm-data-backfill
[vars]
# CRYPTOCOMPARE_API_KEY removed for security - add via secrets

[env.production]
name = "coinswarm-data-ingestion"

[env.staging]
name = "coinswarm-data-ingestion-staging"
